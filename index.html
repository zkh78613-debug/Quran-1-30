<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Daily 100 - IndoPak Quran</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Amiri&display=swap');
        body { font-family: 'Segoe UI', sans-serif; background: #fdfcf0; margin: 0; padding: 20px; direction: rtl; }
        .container { max-width: 900px; margin: auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .header { text-align: center; direction: ltr; margin-bottom: 20px; border-bottom: 2px solid #2d5a27; padding-bottom: 10px; }
        .verse { font-family: 'Amiri', serif; font-size: 32px; line-height: 2.2; text-align: right; padding: 15px; border-bottom: 1px solid #eee; display: inline-block; width: 100%; box-sizing: border-box; }
        .verse-label { font-size: 14px; color: #666; font-family: sans-serif; margin-left: 10px; direction: ltr; display: inline-block; }
        /* HIGHLIGHT FOR THE FINAL VERSE */
        .highlight-stop { background-color: #fffae6; border: 3px solid #f1c40f; border-radius: 10px; position: relative; }
        .highlight-stop::before { content: "üéØ FINISH DAY HERE"; position: absolute; top: -15px; left: 10px; background: #f1c40f; color: #000; font-size: 12px; padding: 2px 8px; border-radius: 4px; font-weight: bold; font-family: sans-serif; }
        .btn { background: #2d5a27; color: white; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer; font-size: 16px; margin: 5px; }
        .nav-box { text-align: center; direction: ltr; margin-top: 20px; }
        .surah-title { text-align: center; background: #e9f5e6; padding: 10px; font-size: 24px; font-weight: bold; margin: 20px 0; border-radius: 5px; color: #2d5a27; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Quran Daily 100</h1>
        <p id="progressText">Calculating Day...</p>
        <button class="btn" onclick="prevDay()">‚¨ÖÔ∏è Back</button>
        <button class="btn" onclick="nextDay()">Mark Done & Next Day ‚û°Ô∏è</button>
    </div>

    <div id="quranContent">Loading Indo-Pak script...</div>

    <div class="nav-box">
        <button class="btn" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">Scroll to Top</button>
    </div>
</div>

<script>
    const surahData = [7,286,200,176,120,165,206,75,129,109,123,111,43,52,99,128,111,110,98,135,112,78,118,64,77,227,93,88,69,60,34,30,73,54,45,83,182,88,75,85,54,53,89,59,37,35,38,29,18,45,60,49,62,55,78,96,29,22,24,13,14,11,11,18,12,12,30,52,52,44,28,28,20,56,40,31,50,40,46,42,42,15,25,22,17,19,26,30,20,15,21,11,8,8,11,5,8,8,11,11,8,3,9,5,4,7,3,6,3,5,4,5,6];
    
    let currentDay = localStorage.getItem('quranDay') ? parseInt(localStorage.getItem('quranDay')) : 1;

    function getRef(absIdx) {
        let count = 0;
        for (let i = 0; i < surahData.length; i++) {
            if (count + surahData[i] >= absIdx) return { s: i + 1, v: absIdx - count };
            count += surahData[i];
        }
        return { s: 114, v: 6 };
    }

    async function loadReader() {
        const display = document.getElementById('quranContent');
        display.innerHTML = "Fetching verses...";
        
        let start = ((currentDay - 1) * 100) + 1;
        let end = currentDay * 100;
        let startRef = getRef(start);
        let endRef = getRef(end);

        document.getElementById('progressText').innerText = `Day ${currentDay} | Target: Surah ${endRef.s}, Verse ${endRef.v}`;

        let html = "";
        // Load all surahs between start and end
        for (let sNum = startRef.s; sNum <= endRef.s; sNum++) {
            html += `<div class="surah-title">Chapter ${sNum}</div>`;
            const res = await fetch(`https://api.quran.com/api/v4/quran/verses/indopak?chapter_number=${sNum}`);
            const data = await res.json();
            
            data.verses.forEach((v, i) => {
                let vNum = i + 1;
                let isInside = false;
                if (sNum > startRef.s && sNum < endRef.s) isInside = true;
                if (sNum === startRef.s && vNum >= startRef.v && (sNum < endRef.s || vNum <= endRef.v)) isInside = true;
                if (sNum === endRef.s && vNum <= endRef.v && (sNum > startRef.s || vNum >= startRef.v)) isInside = true;

                if (isInside) {
                    let highlight = (sNum === endRef.s && vNum === endRef.v) ? "highlight-stop" : "";
                    html += `<div class="verse ${highlight}"><span class="verse-label">${sNum}:${vNum}</span> ${v.text_indopak}</div>`;
                }
            });
        }
        display.innerHTML = html;
    }

    function nextDay() { currentDay++; localStorage.setItem('quranDay', currentDay); loadReader(); window.scrollTo(0,0); }
    function prevDay() { if(currentDay > 1) {currentDay--; localStorage.setItem('quranDay', currentDay); loadReader(); window.scrollTo(0,0);} }

    loadReader();
</script>

</body>
</html>
